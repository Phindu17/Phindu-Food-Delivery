<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Phindu Food Delivery</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>

        <header>
            <h1> Phindu Food Delivery </h1>
            <p> Order food from resturants </p>
        </header>

        <section class="resturants">
            <h2>Resturants in Mzuzu</h2>

            <div class="resturants">
                <h3>Kips Resturants</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Chicken & Chips', 12000, 'Kips')">Add Chicken & Chips-MWK12000</button>
            </div>

             <div class="resturants">
                <h3>Galitos</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Grilled Chicken', 8000, 'Galitos')">Add Grilled Chicken - MWK8000</button>
            </div>

             <div class="resturants">
                <h3>Chicken Lito</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Chicken Burger', 6500, 'Chicken Lito')">Add Chicken Burger - MWK6500</button>
            </div>

             <div class="resturants">
                <h3>KwithuCofee Den</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Cofee Tea', 5000, 'KwithuCofee Den')">Add Cofee Tea - MWK5000</button>
            </div>

             <div class="resturants">
                <h3>Bella's Food Court</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Rice & Beef', 12000, 'Bellas Food Court')">Add Rice & Beef - MWK12000</button>
            </div>

             <div class="resturants">
                <h3>Macondo Camp</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Chicken Pizza', 28000, 'Macondo Camp')">Add Chicken & Chips - MWK12000</button>
            </div>

              <div class="resturants">
                <h3>Serenity Gardens</h3>
                <p> Mzuzu City </p>
                <button onclick="addToCart('Ice creams', 5000, 'Serenity Gardens')">Add Ice Cream - MWK5000</button>
            </div>

            
        </section>

          <section class="cart">
                <h2>Your Cart</h2>
                <ul id="cartItems"></ul>
                <h3>Total: MWK <span id="total">0</span></h3>
                <h3>Delivery Fee: MWK <span id="deliveryFee">0</span></h3>
                <h2>Grand Total: MWK <span id="grandTotal">0</span></h2>

                <button onclick="clearCart()">Clear Cart</button>

                <input type="text" id="name" placeholder="Your Name"><br><br>
                <input type="text" id="phone" placeholder="Phone Number"><br><br>
                <input type="text" id="location" placeholder="Delivery Location" oninput="updateTotals()"><br><br>

                <h3>Select Payment Method</h3>
                <select id="paymentMethod">
                <option value="cod">Pay On Delivery</option>
                <option value="airtel">Airtel Money</option>
                <option value="mpamba">TNM Mpamba</option>
                </select><br><br>

                <button onclick="placeOrder()">Place Order</button>
                </section>

                <footer>
                  <p>&copy; 2026 Phindu Food Delivery</p>
                </footer>

                <script src="script.js"></script>

            <!--Firebase SDK-->
            <script type="module">
                import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
                import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

              //  PASTE YOUR FIREBASE CONFIG HERE
const firebaseConfig = {
  apiKey: "AIzaSyALtR0mlpKS-LPtePOAdyZfcHLnkAzY1sE",
  authDomain: "phindu-food.firebaseapp.com",
  projectId: "phindu-food",
  storageBucket: "phindu-food.firebasestorage.app",
  messagingSenderId: "592904945081",
  appId: "1:592904945081:web:021915a3801648eca14168",
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Place Order Function
window.placeOrder = async function() {

  const name = document.getElementById("name").value;
  const phone = document.getElementById("phone").value;
  const location = document.getElementById("location").value;
  const paymentMethod = document.getElementById("paymentMethod").value;

  if (!name || !phone || !location) {
    alert("Please fill all fields");
    return;
  }

  try {
    await addDoc(collection(db, "orders"), {
  customerName: name,
  phone: phone,
  location: location,
  items: cart,
  foodTotal: total,
  deliveryFee: deliveryFee,
  total: grandTotal,
  restaurant: cart[0].restaurant,
  paymentMethod: paymentMethod,
  paymentStatus: paymentMethod === "cod" ? "Pending" : "Waiting Confirmation",
  status: "Pending",
  rider: "Not Assigned",
  commission: total * 0.10,
  createdAt: new Date()
});

    alert("Order Placed Successfully!");
    location.reload();


      cart = [];
      total = 0;
      displayCart();
  } 
  
  catch (error) {
    alert("Error placing order");
    console.error(error);
  }
}
            
    </script>   
    </body>
</html>